- name: Deploy MySQL
  k8s:
    state: present
    definition:
      apiVersion: v1
      kind: Service
      metadata:
        name: mysql-service
        namespace: db
      spec:
        ports:
        - port: 3306
        selector:
          app: mysql
      ---
      apiVersion: apps/v1
      kind: Deployment
      metadata:
        name: mysql
        namespace: db
      spec:
        replicas: 1
        selector:
          matchLabels:
            app: mysql
        template:
          metadata:
            labels:
              app: mysql
          spec:
            containers:
            - name: mysql
              image: mysql:5.7
              env:
              - name: MYSQL_ROOT_PASSWORD
                value: "password"
              - name: MYSQL_DATABASE
                value: "userdb"
